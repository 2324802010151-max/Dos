<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Hệ thống Giám sát Tấn công</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; transition: background 0.5s; text-align: center; padding-top: 100px; }
        .status-card { background: white; padding: 30px; border-radius: 15px; display: inline-block; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        #status-icon { font-size: 50px; }
        .safe { background-color: #2ecc71; color: white; }
        .attacked { background-color: #e74c3c; color: white; animation: shake 0.5s infinite; }
        
        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }
    </style>
</head>
<body id="main-body" class="safe">
    <div class="status-card">
        <div id="status-icon">✅</div>
        <h1 id="status-text">HỆ THỐNG BÌNH THƯỜNG</h1>
        <p>Đang giám sát các yêu cầu từ: <b id="target-url"></b></p>
        <p>Độ trễ phản hồi: <span id="latency">0</span> ms</p>
    </div>

    <script>
        const body = document.getElementById('main-body');
        const statusText = document.getElementById('status-text');
        const statusIcon = document.getElementById('status-icon');
        const latencyText = document.getElementById('latency');
        document.getElementById('target-url').innerText = window.location.href;

        async function checkServerStatus() {
            const start = Date.now();
            try {
                // Gửi request nhẹ tới chính server
                const response = await fetch(window.location.href, { method: 'HEAD', cache: 'no-store' });
                const latency = Date.now() - start;
                latencyText.innerText = latency;

                if (latency > 1000) { // Nếu phản hồi chậm trên 1 giây
                    setAttacked("SERVER PHẢN HỒI CHẬM (Có dấu hiệu DoS)");
                } else {
                    setSafe();
                }
            } catch (error) {
                // Nếu không thể fetch (do SYN Flood làm nghẽn hoặc sập server)
                setAttacked("CẢNH BÁO: MẤT KẾT NỐI - ĐANG BỊ TẤN CÔNG!");
            }
        }

        function setAttacked(msg) {
            body.className = 'attacked';
            statusText.innerText = msg;
            statusIcon.innerText = '⚠️';
        }

        function setSafe() {
            body.className = 'safe';
            statusText.innerText = "HỆ THỐNG BÌNH THƯỜNG";
            statusIcon.innerText = '✅';
        }

        // Kiểm tra mỗi 2 giây
        setInterval(checkServerStatus, 2000);
    </script>
</body>
</html>
